<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>길드 공용코어 목록</title>

<style>
body {
  font-family: system-ui, sans-serif;
  background:#0f0f0f;
  color:#f1f1f1;
  margin:0;
  padding:16px;
}
h1 { font-size:1.4rem; }
h2 { margin-top:24px; font-size:1.2rem; }
.tag { color:#aaa; font-size:0.9rem; margin-bottom:10px; }

button, input, textarea {
  width:100%;
  box-sizing:border-box;
  font-size:1rem;
  padding:10px;
  margin:4px 0;
}
button {
  background:#2f2f2f;
  color:#fff;
  border:none;
  border-radius:6px;
}
button:hover { background:#444; }

input, textarea {
  background:#1a1a1a;
  color:#fff;
  border:1px solid #333;
  border-radius:6px;
}

.admin {
  background:#141414;
  padding:10px;
  border-radius:8px;
  margin-bottom:12px;
}

.item {
  border-bottom:1px solid #222;
  padding:10px 0;
}

.row { display:flex; gap:6px; }
.row button { flex:1; }

.hidden { display:none; }
</style>
</head>

<body>

<h1>길드 공용코어 목록</h1>
<p class="tag">고철리카 문의 : 똘형</p>

<div id="login" class="admin">
  <input type="password" id="pw" placeholder="관리자 비밀번호">
  <button onclick="login()">관리자 접속</button>
</div>

<div id="editor" class="admin hidden">
  <textarea id="newText" rows="3" placeholder="새 공용코어 입력"></textarea>
  <button onclick="addCore()">공용코어 추가</button>
</div>

<input type="text" id="search" placeholder="검색 (짐 / 드 / 악 / 메 / 미 / 새 / 곤 / 힘 / 200 / 제스터)" oninput="renderCores()">

<div id="coreList"></div>

<h2>코어 대여자 목록</h2>

<div id="renterEditor" class="admin hidden">
  <textarea id="newRenter" rows="2" placeholder="대여자 정보 입력 (예: 폭주제스터 → 홍길동)"></textarea>
  <button onclick="addRenter()">대여자 추가</button>
</div>

<div id="renterList"></div>

<script>
const PASSWORD = "030219";
let isAdmin = false;

/* ================= 공용코어 데이터 ================= */

const defaultCores = [
`191 (미)힘 네오삐에볼`,
`191 (짐)운 네오민트호냥`,
`193 날 켈베로스`,
`192 (식)운 뷔로사(폭주 믹스 예정)`,
`192 (새)힘 미카엘(폭주 믹스 예정)`,
`192 (새)정 미카엘(뉴갈 믹스 예정)`,
`193 (악)속 사다귀`,
`193 (미)속 제스터(폭주 믹스 예정)`,
`193 (미)힘 제스터(폭주 믹스 예정)`,
`193 (미)힘 티어스`,
`194 (곤)운 호타루(폭주 믹스 예정)`,
`194 (곤)석 루카누(폭주 믹스 예정)`,
`195 (드)운 요르문(폭주 믹스 예정)`,
`195 (드)운 요르문(폭주 믹스 예정)`,
`195 (메)힘 발록(폭주 믹스 예정)`,
`196 (악)운 환영마녀`,
`196 (악)날 환영마녀`,
`196 (악)속 다크리벤`,
`196 (악)정 네오오르데빌`,
`198 (식)힘 폭주뷔로사`,
`198 (식)운 폭주뷔로사`,
`198 (새)정 폭주미카엘`,
`198 (메)힘 네오메탈리카`,
`199 (식)속 지니`,
`199 (미)힘 폭주 제스터`,
`200 (미)속 폭주스노균`,
`200 (악)정 폭주루시퍼`,
`200 (곤)운 폭주호타루`,
`200 (짐)날 폭주 나굴이`,
`201 (메)운 폭주발록`,
`201 (메)힘 폭주발록`,
`201 (드)속 폭주요르문`,
`201 (드)날 폭주파이어드래곤(2콰)`,
`205 (메)날 뉴메탈탱크`,
`205 (새)날 불멸윙클레셔(1콰)`,
`210 (곤)운 불멸집게마왕`,
`210 (짐)날 데미헬파드`,
`221 (식)날 불멸클로라(1콰)`,
`221 (악)날 불멸베레스(1콰)`,
`223 (드)날 불멸아리만트(2콰)`,
`-----후원------`,
`(코래)198 (드)속 뉴가루곤`,
`(코래)197 (식)날 뉴블루덤블`,
`(코래)200 (악)날 폭주루시퍼`,
`(코래)210 (곤)운 불멸집게마왕`,
`(ajrrl) 193(미)날 제스터`,
`(ajrrl) 199(미)날 폭주제스터`
];

let cores = JSON.parse(localStorage.getItem("cores")) || defaultCores;

function saveCores(){
  localStorage.setItem("cores", JSON.stringify(cores));
}

/* ================= 대여자 ================= */

let renters = JSON.parse(localStorage.getItem("renters")) || [];

function saveRenters(){
  localStorage.setItem("renters", JSON.stringify(renters));
}

/* ================= 로그인 ================= */

function login(){
  if(pw.value === PASSWORD){
    isAdmin = true;
    editor.classList.remove("hidden");
    renterEditor.classList.remove("hidden");
    login.classList.add("hidden");
    renderCores();
    renderRenters();
  } else alert("비밀번호 오류");
}

/* ================= 파싱 ================= */

function parseCore(text){
  let cleaned = text.replace(/^\([^)]*\)\s*/, '');
  const m = cleaned.match(/^(\d+)\s*\(([^)]+)\)([^\s]+)?\s*(.*)$/);
  if(!m) return null;
  return { level:m[1], type:m[2], attr:m[3]||"", name:m[4]||"" };
}

/* ================= 공용코어 ================= */

function addCore(){
  if(!newText.value.trim()) return;
  cores.push(newText.value.trim());
  newText.value="";
  saveCores(); renderCores();
}

function editCore(i){
  const v = prompt("수정", cores[i]);
  if(v){ cores[i]=v; saveCores(); renderCores(); }
}

function delCore(i){
  if(confirm("삭제?")){
    cores.splice(i,1);
    saveCores(); renderCores();
  }
}

function renderCores(){
  const q = search.value.trim().toLowerCase();
  coreList.innerHTML="";

  cores.forEach((t,i)=>{
    const p = parseCore(t);
    let ok = true;

    if(q){
      if(["짐","드","악","메","미","새","곤"].includes(q)) ok = p && p.type===q;
      else if(["힘","운","속","날","정","석"].includes(q)) ok = p && p.attr===q;
      else if(/^\d+$/.test(q)) ok = p && p.level===q;
      else ok = t.toLowerCase().includes(q);
    }

    if(!ok) return;

    const d = document.createElement("div");
    d.className="item";
    d.innerHTML = `<div>${t}</div>` +
      (isAdmin ? `<div class="row">
        <button onclick="editCore(${i})">수정</button>
        <button onclick="delCore(${i})">삭제</button>
      </div>` : "");
    coreList.appendChild(d);
  });
}

/* ================= 대여자 ================= */

function addRenter(){
  if(!newRenter.value.trim()) return;
  renters.push(newRenter.value.trim());
  newRenter.value="";
  saveRenters(); renderRenters();
}

function editRenter(i){
  const v = prompt("수정", renters[i]);
  if(v){ renters[i]=v; saveRenters(); renderRenters(); }
}

function delRenter(i){
  if(confirm("삭제?")){
    renters.splice(i,1);
    saveRenters(); renderRenters();
  }
}

function renderRenters(){
  renterList.innerHTML="";
  renters.forEach((r,i)=>{
    const d=document.createElement("div");
    d.className="item";
    d.innerHTML = `<div>${r}</div>` +
      (isAdmin ? `<div class="row">
        <button onclick="editRenter(${i})">수정</button>
        <button onclick="delRenter(${i})">삭제</button>
      </div>` : "");
    renterList.appendChild(d);
  });
}

/* 초기 실행 */
renderCores();
renderRenters();
</script>

</body>
</html>
